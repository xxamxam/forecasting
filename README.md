# forecasting

В этом репозитории представлена лабораторная работа по курсу 'Математические методы прогнозирования'

Я взял работу № 404: аппроксимация временного ряда потребления электричества нейронными сетями LSTM и Neural ODE. Под аппроксимацией имеется в виду предсказание будущих значений по известному набору предыдущих.

Про датасет: представлены измерения потребления электричества с периодом в час за длительный промежуток времени. К этой информации добавляется информация о температуре на улице в этот момент. 

Что делаю: Будем предсказывать потребление в следующий час  по потреблению в предыдущие 9 часов. Во второй части добавлю данные о температуре. Данные делятся на train и test, для train берется более древняя часть датасета, для теста -- более поздняя. Тестовые данные не попадают в train. Для предсказания потребления в какой-то момент времени используются 9 предыдущих значений потребления. Для улучшения тренировки train перемешивается -- это помогает декоррелировать элементы в батче.

В качестве моделей используются `LSTM` и `Neural ODE` с LSTM  в качестве дифференциальной функции. Модели оптимизируются L2 лоссом, так как нужно научиться предсказывать среднее значение. оптимизатор Adam и тренировка проходит в 50 эпох.

Также в Neural ODE введен internal loss. Это подсчет лосса по промежуточным предсказаниям. Обучение показало что это улучшает обучение.

## процесс выполнения работы
сначала рассмотрел предсказание потребления энергии без использования данных о погоде. В результате получил что LSTM может неплохо предсказывать потребление энергии. 

Neural-ODE показывает лоссы ниже. При этом Neural ODE сильно раньше начинает показывать хорошие результаты, не совсем понял с чем это связано. 

